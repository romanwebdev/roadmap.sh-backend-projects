<!DOCTYPE html>
<html lang="en">
  <%- include('./partials/head.ejs') %>
  <body>
    <div class="container">
      <header>
        <h1>Personal Blog</h1>
        <% if (isAdmin) { %>
          <a href="/admin/new">+ Add</a>
        <% } %>
      </header>
      <ul>
        <% posts.forEach(function(post) { %> 
        <li>
          <% if (isAdmin) { %>
            <div class="post">
              <p><%- post.title %></p>
              <div class="post-actions">
                <a href=<%- `/admin/edit/${post.id}` %>>Edit</a>
                <form action=<%- `/admin/delete/${post.id}` %> method="POST" style="display:inline;">
                  <button type="submit" onclick="return confirm('Are you sure you want to delete this post?');">
                    Delete
                  </button>
                </form>
              </div>
            </div>
          <% } else { %>
            <a href=<%- `/article/${post.id}` %> class="post-link">
              <p><%- post.title %></p>
              <time datetime=<%- post.date %>><%- new Date(post.date).toLocaleDateString("en-US", {
                year: "numeric",
                month: "long",
                day: "numeric",
              }) %></time>
            </a>
          <% } %>
        </li>
        <% }) %>
      </ul>
    </div>
  </body>
</html>
